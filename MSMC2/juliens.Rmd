---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r eval=FALSE, include=FALSE}
setwd("/home/taliadoros/Desktop/phd_projects/Ptt/New_full/Newest/MSMC2/vcf_from_bam2/pops/all_chroms")

read.demo <- function(file, pop) {
  demo <- read.table(file, header = TRUE)
  demo$Time <- with(demo, (right_time_boundary + left_time_boundary) / 2)
  demo$Population <- pop
  return(demo)
}

demo1 <- read.demo("Iran_1.msmc.final.txt", pop = "Iran")
demo2 <- read.demo("France_1.msmc.final.txt", pop = "Europe")
demo3 <- read.demo("Morocco_1.msmc.final.txt", pop = "Morocco")
demo4 <- read.demo("ND_1.msmc.final.txt", pop = "North_Dakota")
demo5 <- read.demo("Mixed_1.msmc.final.txt", pop = "Mixed")

demo <- rbind(demo1, demo2, demo3, demo4,demo5)
#demo$Population <- factor(demo$Population, levels = c("Mixed", "ABCPQRSTUV", "DEFGIKMNO", "LHJ")) # Reorder populations for plotting

# Get mutation rate, using Munkacsi et al 2007, table 4.
#mut <- c(5.00, 5.25, 6.00, 5.25, 6.00, 6.23,
#         4.07, 4.59, 4.15, 4.21, 3.77, 4.28,
#         8.60, 7.58, 10.66, 7.76, 10.84, 9.82,
#         3.33, 3.17, 3.06, 3.44, 3.34, 3.18)*1e-9
#hist(mut) # Exponentially distributed
#u <- exp(mean(log(mut)))
u <- 3.01e-8

library(ggplot2)
library(ggthemes)

g <- 1
p.pop <- ggplot(demo, aes(x = Time*g/u/1000, y = (1/lambda)/(2*u))) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e8, fill = gray(0.5)) +
  geom_line(aes(col = Population), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10(breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) + 
  ylab(expression(Ne)) + xlab("Time (ky)") +
  scale_color_brewer(type = "qual", palette = 1) +
  theme_bw() + theme(legend.position = "top", legend.direction = "vertical")
p.pop

p.lambda <- ggplot(demo, aes(x = Time*g/u/1000, y = lambda)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e5, fill = gray(0.5)) +
  geom_line(aes(col = Population), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10(breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_brewer(type = "qual", palette = 1) +
  theme_bw() + theme(legend.position = "top", legend.direction = "vertical")
p.lambda

demo.cross <- read.table("Ir-ND.allrates.txt", header = TRUE)
demo.cross$Time <- with(demo.cross, (right_time_boundary + left_time_boundary) / 2)

library(reshape2)
demo.cross2 <- reshape2::melt(demo.cross, id.vars = c("Time", "time_index", "left_time_boundary", "right_time_boundary"), variable.name = "lambda")
demo.cross2$lambda <- factor(substring(demo.cross2$lambda, 8), levels = c("00", "11", "01"), labels = c("Within Iran", "Within ND", "Cross"))

p.cross <- ggplot(demo.cross2, aes(x = Time*g/u/1000, y = value)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e6, fill = gray(0.5)) +
  geom_line(aes(col = lambda), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross





#library(cowplot)
#pp <- plot_grid(p.pop, p.cross, align = "h", labels = "AUTO")
#pp


# Look at permutations:

demo.rep.lst <- list()
for (i in 1:5) {
  tmp <- read.table(paste("Ir-ND_", i, ".allrates.txt", sep = ""), header = TRUE)
  tmp$Time <- with(tmp, (right_time_boundary + left_time_boundary) / 2)
  tmp$Rep <- i
  demo.rep.lst[[i]] <- tmp
}
require(data.table)
demo.rep <- rbindlist(demo.rep.lst)

p.rep <- ggplot(demo.rep, aes(x = Time*g/u, y = lambda_01, group = as.factor(Rep))) + geom_line() +
  scale_y_log10() + scale_x_log10() +
  theme_bw()
p.rep

demo.rep2 <- demo.rep
demo.rep2$lambda <- "Randomized"
demo.rep2$value <- demo.rep2$lambda_01
demo.rep2$lambda_00 <- NULL
demo.rep2$lambda_01 <- NULL
demo.rep2$lambda_11 <- NULL
demo.rep2$Sim <- TRUE
demo.rep2$Rep <- as.factor(demo.rep2$Rep)
demo.cross2$Rep <- demo.cross2$lambda
demo.cross2$Sim <- FALSE
demo.cross3 <- rbind(demo.cross2, as.data.frame(demo.rep2)[, names(demo.cross2)])

p.cross20 <- ggplot(demo.cross3, aes(x = Time*g/u/1000, y = value, col = lambda, group = as.factor(Rep), alpha = Sim)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e5, fill = gray(0.5)) +
  geom_line(size = 1) + scale_alpha_manual(values = c("TRUE" = 0.3, "FALSE" = 1)) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() + guides(alpha = FALSE) +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross20

#pp2 <- plot_grid(p.pop, p.cross2, align = "h", labels = "AUTO")
#pp2

#ggsave(pp2, file = "Figure_MSMC.pdf", width = 10, height = 6)

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.
```{r eval=FALSE, include=FALSE}
demo.cross <- read.table("Ir-Morocco.allrates.txt", header = TRUE)
demo.cross$Time <- with(demo.cross, (right_time_boundary + left_time_boundary) / 2)

library(reshape2)
demo.cross2 <- reshape2::melt(demo.cross, id.vars = c("Time", "time_index", "left_time_boundary", "right_time_boundary"), variable.name = "lambda")
demo.cross2$lambda <- factor(substring(demo.cross2$lambda, 8), levels = c("00", "11", "01"), labels = c("Within Iran", "Within Morocco", "Cross"))

p.cross <- ggplot(demo.cross2, aes(x = Time*g/u/1000, y = value)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e6, fill = gray(0.5)) +
  geom_line(aes(col = lambda), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross





#library(cowplot)
#pp <- plot_grid(p.pop, p.cross, align = "h", labels = "AUTO")
#pp


# Look at permutations:

demo.rep.lst <- list()
for (i in 1:5) {
  tmp <- read.table(paste("Ir-Morocco_", i, ".allrates.txt", sep = ""), header = TRUE)
  tmp$Time <- with(tmp, (right_time_boundary + left_time_boundary) / 2)
  tmp$Rep <- i
  demo.rep.lst[[i]] <- tmp
}
require(data.table)
demo.rep <- rbindlist(demo.rep.lst)

p.rep <- ggplot(demo.rep, aes(x = Time*g/u, y = lambda_01, group = as.factor(Rep))) + geom_line() +
  scale_y_log10() + scale_x_log10() +
  theme_bw()
p.rep

demo.rep2 <- demo.rep
demo.rep2$lambda <- "Randomized"
demo.rep2$value <- demo.rep2$lambda_01
demo.rep2$lambda_00 <- NULL
demo.rep2$lambda_01 <- NULL
demo.rep2$lambda_11 <- NULL
demo.rep2$Sim <- TRUE
demo.rep2$Rep <- as.factor(demo.rep2$Rep)
demo.cross2$Rep <- demo.cross2$lambda
demo.cross2$Sim <- FALSE
demo.cross3 <- rbind(demo.cross2, as.data.frame(demo.rep2)[, names(demo.cross2)])

p.cross21 <- ggplot(demo.cross3, aes(x = Time*g/u/1000, y = value, col = lambda, group = as.factor(Rep), alpha = Sim)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e5, fill = gray(0.5)) +
  geom_line(size = 1) + scale_alpha_manual(values = c("TRUE" = 0.3, "FALSE" = 1)) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() + guides(alpha = FALSE) +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross21

#pp2 <- plot_grid(p.pop, p.cross2, align = "h", labels = "AUTO")
#pp2
```


```{r}
demo.cross <- read.table("ND_Fr.allrates.txt", header = TRUE)
demo.cross$Time <- with(demo.cross, (right_time_boundary + left_time_boundary) / 2)

library(reshape2)
demo.cross2 <- reshape2::melt(demo.cross, id.vars = c("Time", "time_index", "left_time_boundary", "right_time_boundary"), variable.name = "lambda")
demo.cross2$lambda <- factor(substring(demo.cross2$lambda, 8), levels = c("00", "11", "01"), labels = c("Within ND", "Within Europe", "Cross"))

p.cross <- ggplot(demo.cross2, aes(x = Time*g/u/1000, y = value)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e6, fill = gray(0.5)) +
  geom_line(aes(col = lambda), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross





#library(cowplot)
#pp <- plot_grid(p.pop, p.cross, align = "h", labels = "AUTO")
#pp


# Look at permutations:

demo.rep.lst <- list()
for (i in 1:5) {
  tmp <- read.table(paste("ND_Fr_", i, ".allrates.txt", sep = ""), header = TRUE)
  tmp$Time <- with(tmp, (right_time_boundary + left_time_boundary) / 2)
  tmp$Rep <- i
  demo.rep.lst[[i]] <- tmp
}
require(data.table)
demo.rep <- rbindlist(demo.rep.lst)

p.rep <- ggplot(demo.rep, aes(x = Time*g/u, y = lambda_01, group = as.factor(Rep))) + geom_line() +
  scale_y_log10() + scale_x_log10() +
  theme_bw()
p.rep

demo.rep2 <- demo.rep
demo.rep2$lambda <- "Randomized"
demo.rep2$value <- demo.rep2$lambda_01
demo.rep2$lambda_00 <- NULL
demo.rep2$lambda_01 <- NULL
demo.rep2$lambda_11 <- NULL
demo.rep2$Sim <- TRUE
demo.rep2$Rep <- as.factor(demo.rep2$Rep)
demo.cross2$Rep <- demo.cross2$lambda
demo.cross2$Sim <- FALSE
demo.cross3 <- rbind(demo.cross2, as.data.frame(demo.rep2)[, names(demo.cross2)])

p.cross22 <- ggplot(demo.cross3, aes(x = Time*g/u/1000, y = value, col = lambda, group = as.factor(Rep), alpha = Sim)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e5, fill = gray(0.5)) +
  geom_line(size = 1) + scale_alpha_manual(values = c("TRUE" = 0.3, "FALSE" = 1)) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() + guides(alpha = FALSE) +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross22

#pp2 <- plot_grid(p.pop, p.cross2, align = "h", labels = "AUTO")
#pp2
```

```{r}
demo.cross <- read.table("Ir-Fr.allrates.txt", header = TRUE)
demo.cross$Time <- with(demo.cross, (right_time_boundary + left_time_boundary) / 2)

library(reshape2)
demo.cross2 <- reshape2::melt(demo.cross, id.vars = c("Time", "time_index", "left_time_boundary", "right_time_boundary"), variable.name = "lambda")
demo.cross2$lambda <- factor(substring(demo.cross2$lambda, 8), levels = c("00", "11", "01"), labels = c("Within Iran", "Within Europe", "Cross"))

p.cross <- ggplot(demo.cross2, aes(x = Time*g/u/1000, y = value)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e6, fill = gray(0.5)) +
  geom_line(aes(col = lambda), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross
#######################################################################
demo.cross$rccr <-  (2*demo.cross$lambda_01)/(demo.cross$lambda_00+demo.cross$lambda_11)

p.cross <- ggplot(demo.cross, aes(x = Time*g/u/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") +
  scale_color_continuous() +
  theme_bw() +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross
########################################################################
#library(cowplot)
#pp <- plot_grid(p.pop, p.cross, align = "h", labels = "AUTO")
#pp


# Look at permutations:

demo.rep.lst <- list()
for (i in 1:5) {
  tmp <- read.table(paste("Ir-Fr_", i, ".allrates.txt", sep = ""), header = TRUE)
  tmp$Time <- with(tmp, (right_time_boundary + left_time_boundary) / 2)
  tmp$Rep <- i
  demo.rep.lst[[i]] <- tmp
}
require(data.table)
demo.rep <- rbindlist(demo.rep.lst)

p.rep <- ggplot(demo.rep, aes(x = Time*g/u, y = lambda_01, group = as.factor(Rep))) + geom_line() +
  scale_y_log10() + scale_x_log10() +
  theme_bw()
p.rep

demo.rep2 <- demo.rep
demo.rep2$lambda <- "Randomized"
demo.rep2$value <- demo.rep2$lambda_01
demo.rep2$lambda_00 <- NULL
demo.rep2$lambda_01 <- NULL
demo.rep2$lambda_11 <- NULL
demo.rep2$Sim <- TRUE
demo.rep2$Rep <- as.factor(demo.rep2$Rep)
demo.cross2$Rep <- demo.cross2$lambda
demo.cross2$Sim <- FALSE
demo.cross3 <- rbind(demo.cross2, as.data.frame(demo.rep2)[, names(demo.cross2)])

p.cross23 <- ggplot(demo.cross3, aes(x = Time*g/u/1000, y = value, col = lambda, group = as.factor(Rep), alpha = Sim)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e5, fill = gray(0.5)) +
  geom_line(size = 1) + scale_alpha_manual(values = c("TRUE" = 0.3, "FALSE" = 1)) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() + guides(alpha = FALSE) +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross23

#pp2 <- plot_grid(p.pop, p.cross2, align = "h", labels = "AUTO")
#pp2
```

```{r}
demo.cross <- read.table("Ir-Mixed.allrates.txt", header = TRUE)
demo.cross$Time <- with(demo.cross, (right_time_boundary + left_time_boundary) / 2)

library(reshape2)
demo.cross2 <- reshape2::melt(demo.cross, id.vars = c("Time", "time_index", "left_time_boundary", "right_time_boundary"), variable.name = "lambda")
demo.cross2$lambda <- factor(substring(demo.cross2$lambda, 8), levels = c("00", "11", "01"), labels = c("Within Iran", "Within Mixed", "Cross"))

p.cross <- ggplot(demo.cross2, aes(x = Time*g/u/1000, y = value)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e6, fill = gray(0.5)) +
  geom_line(aes(col = lambda), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross





#library(cowplot)
#pp <- plot_grid(p.pop, p.cross, align = "h", labels = "AUTO")
#pp


# Look at permutations:

demo.rep.lst <- list()
for (i in 1:5) {
  tmp <- read.table(paste("Ir-Mixed_", i, ".allrates.txt", sep = ""), header = TRUE)
  tmp$Time <- with(tmp, (right_time_boundary + left_time_boundary) / 2)
  tmp$Rep <- i
  demo.rep.lst[[i]] <- tmp
}
require(data.table)
demo.rep <- rbindlist(demo.rep.lst)

p.rep <- ggplot(demo.rep, aes(x = Time*g/u, y = lambda_01, group = as.factor(Rep))) + geom_line() +
  scale_y_log10() + scale_x_log10() +
  theme_bw()
p.rep

demo.rep2 <- demo.rep
demo.rep2$lambda <- "Randomized"
demo.rep2$value <- demo.rep2$lambda_01
demo.rep2$lambda_00 <- NULL
demo.rep2$lambda_01 <- NULL
demo.rep2$lambda_11 <- NULL
demo.rep2$Sim <- TRUE
demo.rep2$Rep <- as.factor(demo.rep2$Rep)
demo.cross2$Rep <- demo.cross2$lambda
demo.cross2$Sim <- FALSE
demo.cross3 <- rbind(demo.cross2, as.data.frame(demo.rep2)[, names(demo.cross2)])

p.cross24 <- ggplot(demo.cross3, aes(x = Time*g/u/1000, y = value, col = lambda, group = as.factor(Rep), alpha = Sim)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e5, fill = gray(0.5)) +
  geom_line(size = 1) + scale_alpha_manual(values = c("TRUE" = 0.3, "FALSE" = 1)) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() + guides(alpha = FALSE) +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross24

#pp2 <- plot_grid(p.pop, p.cross2, align = "h", labels = "AUTO")
#pp2
```


```{r}
demo.cross <- read.table("ND_Mixed.allrates.txt", header = TRUE)
demo.cross$Time <- with(demo.cross, (right_time_boundary + left_time_boundary) / 2)

library(reshape2)
demo.cross2 <- reshape2::melt(demo.cross, id.vars = c("Time", "time_index", "left_time_boundary", "right_time_boundary"), variable.name = "lambda")
demo.cross2$lambda <- factor(substring(demo.cross2$lambda, 8), levels = c("00", "11", "01"), labels = c("Within ND", "Within Mixed", "Cross"))

p.cross <- ggplot(demo.cross2, aes(x = Time*g/u/1000, y = value)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e6, fill = gray(0.5)) +
  geom_line(aes(col = lambda), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross





#library(cowplot)
#pp <- plot_grid(p.pop, p.cross, align = "h", labels = "AUTO")
#pp


# Look at permutations:

demo.rep.lst <- list()
for (i in 1:5) {
  tmp <- read.table(paste("ND_Mixed_", i, ".allrates.txt", sep = ""), header = TRUE)
  tmp$Time <- with(tmp, (right_time_boundary + left_time_boundary) / 2)
  tmp$Rep <- i
  demo.rep.lst[[i]] <- tmp
}
require(data.table)
demo.rep <- rbindlist(demo.rep.lst)

p.rep <- ggplot(demo.rep, aes(x = Time*g/u, y = lambda_01, group = as.factor(Rep))) + geom_line() +
  scale_y_log10() + scale_x_log10() +
  theme_bw()
p.rep

demo.rep2 <- demo.rep
demo.rep2$lambda <- "Randomized"
demo.rep2$value <- demo.rep2$lambda_01
demo.rep2$lambda_00 <- NULL
demo.rep2$lambda_01 <- NULL
demo.rep2$lambda_11 <- NULL
demo.rep2$Sim <- TRUE
demo.rep2$Rep <- as.factor(demo.rep2$Rep)
demo.cross2$Rep <- demo.cross2$lambda
demo.cross2$Sim <- FALSE
demo.cross3 <- rbind(demo.cross2, as.data.frame(demo.rep2)[, names(demo.cross2)])

p.cross25 <- ggplot(demo.cross3, aes(x = Time*g/u/1000, y = value, col = lambda, group = as.factor(Rep), alpha = Sim)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e5, fill = gray(0.5)) +
  geom_line(size = 1) + scale_alpha_manual(values = c("TRUE" = 0.3, "FALSE" = 1)) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() + guides(alpha = FALSE) +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross25

#pp2 <- plot_grid(p.pop, p.cross2, align = "h", labels = "AUTO")
#pp2
```

```{r}
demo.cross <- read.table("ND_Morocco.allrates.txt", header = TRUE)
demo.cross$Time <- with(demo.cross, (right_time_boundary + left_time_boundary) / 2)

library(reshape2)
demo.cross2 <- reshape2::melt(demo.cross, id.vars = c("Time", "time_index", "left_time_boundary", "right_time_boundary"), variable.name = "lambda")
demo.cross2$lambda <- factor(substring(demo.cross2$lambda, 8), levels = c("00", "11", "01"), labels = c("Within ND", "Within Morocco", "Cross"))

p.cross <- ggplot(demo.cross2, aes(x = Time*g/u/1000, y = value)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e6, fill = gray(0.5)) +
  geom_line(aes(col = lambda), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross





#library(cowplot)
#pp <- plot_grid(p.pop, p.cross, align = "h", labels = "AUTO")
#pp


# Look at permutations:

demo.rep.lst <- list()
for (i in 1:5) {
  tmp <- read.table(paste("ND_Morocco_", i, ".allrates.txt", sep = ""), header = TRUE)
  tmp$Time <- with(tmp, (right_time_boundary + left_time_boundary) / 2)
  tmp$Rep <- i
  demo.rep.lst[[i]] <- tmp
}
require(data.table)
demo.rep <- rbindlist(demo.rep.lst)

p.rep <- ggplot(demo.rep, aes(x = Time*g/u, y = lambda_01, group = as.factor(Rep))) + geom_line() +
  scale_y_log10() + scale_x_log10() +
  theme_bw()
p.rep

demo.rep2 <- demo.rep
demo.rep2$lambda <- "Randomized"
demo.rep2$value <- demo.rep2$lambda_01
demo.rep2$lambda_00 <- NULL
demo.rep2$lambda_01 <- NULL
demo.rep2$lambda_11 <- NULL
demo.rep2$Sim <- TRUE
demo.rep2$Rep <- as.factor(demo.rep2$Rep)
demo.cross2$Rep <- demo.cross2$lambda
demo.cross2$Sim <- FALSE
demo.cross3 <- rbind(demo.cross2, as.data.frame(demo.rep2)[, names(demo.cross2)])

p.cross26 <- ggplot(demo.cross3, aes(x = Time*g/u/1000, y = value, col = lambda, group = as.factor(Rep), alpha = Sim)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e5, fill = gray(0.5)) +
  geom_line(size = 1) + scale_alpha_manual(values = c("TRUE" = 0.3, "FALSE" = 1)) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() + guides(alpha = FALSE) +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross26

#pp2 <- plot_grid(p.pop, p.cross2, align = "h", labels = "AUTO")
#pp2
```

```{r}
demo.cross <- read.table("Fr-Mixed.allrates.txt", header = TRUE)
demo.cross$Time <- with(demo.cross, (right_time_boundary + left_time_boundary) / 2)

library(reshape2)
demo.cross2 <- reshape2::melt(demo.cross, id.vars = c("Time", "time_index", "left_time_boundary", "right_time_boundary"), variable.name = "lambda")
demo.cross2$lambda <- factor(substring(demo.cross2$lambda, 8), levels = c("00", "11", "01"), labels = c("Within Europe", "Within Mixed", "Cross"))

p.cross <- ggplot(demo.cross2, aes(x = Time*g/u/1000, y = value)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e6, fill = gray(0.5)) +
  geom_line(aes(col = lambda), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross





#library(cowplot)
#pp <- plot_grid(p.pop, p.cross, align = "h", labels = "AUTO")
#pp


# Look at permutations:

demo.rep.lst <- list()
for (i in 1:5) {
  tmp <- read.table(paste("Fr-Mixed_", i, ".allrates.txt", sep = ""), header = TRUE)
  tmp$Time <- with(tmp, (right_time_boundary + left_time_boundary) / 2)
  tmp$Rep <- i
  demo.rep.lst[[i]] <- tmp
}
require(data.table)
demo.rep <- rbindlist(demo.rep.lst)

p.rep <- ggplot(demo.rep, aes(x = Time*g/u, y = lambda_01, group = as.factor(Rep))) + geom_line() +
  scale_y_log10() + scale_x_log10() +
  theme_bw()
p.rep

demo.rep2 <- demo.rep
demo.rep2$lambda <- "Randomized"
demo.rep2$value <- demo.rep2$lambda_01
demo.rep2$lambda_00 <- NULL
demo.rep2$lambda_01 <- NULL
demo.rep2$lambda_11 <- NULL
demo.rep2$Sim <- TRUE
demo.rep2$Rep <- as.factor(demo.rep2$Rep)
demo.cross2$Rep <- demo.cross2$lambda
demo.cross2$Sim <- FALSE
demo.cross3 <- rbind(demo.cross2, as.data.frame(demo.rep2)[, names(demo.cross2)])

p.cross27 <- ggplot(demo.cross3, aes(x = Time*g/u/1000, y = value, col = lambda, group = as.factor(Rep), alpha = Sim)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e5, fill = gray(0.5)) +
  geom_line(size = 1) + scale_alpha_manual(values = c("TRUE" = 0.3, "FALSE" = 1)) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() + guides(alpha = FALSE) +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross27

#pp2 <- plot_grid(p.pop, p.cross2, align = "h", labels = "AUTO")
#pp2
```

```{r}
demo.cross <- read.table("Fr-Morocco.allrates.txt", header = TRUE)
demo.cross$Time <- with(demo.cross, (right_time_boundary + left_time_boundary) / 2)

library(reshape2)
demo.cross2 <- reshape2::melt(demo.cross, id.vars = c("Time", "time_index", "left_time_boundary", "right_time_boundary"), variable.name = "lambda")
demo.cross2$lambda <- factor(substring(demo.cross2$lambda, 8), levels = c("00", "11", "01"), labels = c("Within Europe", "Within Morocco", "Cross"))

p.cross <- ggplot(demo.cross2, aes(x = Time*g/u/1000, y = value)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e6, fill = gray(0.5)) +
  geom_line(aes(col = lambda), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross





#library(cowplot)
#pp <- plot_grid(p.pop, p.cross, align = "h", labels = "AUTO")
#pp


# Look at permutations:

demo.rep.lst <- list()
for (i in 1:5) {
  tmp <- read.table(paste("Fr-Morocco_", i, ".allrates.txt", sep = ""), header = TRUE)
  tmp$Time <- with(tmp, (right_time_boundary + left_time_boundary) / 2)
  tmp$Rep <- i
  demo.rep.lst[[i]] <- tmp
}
require(data.table)
demo.rep <- rbindlist(demo.rep.lst)

p.rep <- ggplot(demo.rep, aes(x = Time*g/u, y = lambda_01, group = as.factor(Rep))) + geom_line() +
  scale_y_log10() + scale_x_log10() +
  theme_bw()
p.rep

demo.rep2 <- demo.rep
demo.rep2$lambda <- "Randomized"
demo.rep2$value <- demo.rep2$lambda_01
demo.rep2$lambda_00 <- NULL
demo.rep2$lambda_01 <- NULL
demo.rep2$lambda_11 <- NULL
demo.rep2$Sim <- TRUE
demo.rep2$Rep <- as.factor(demo.rep2$Rep)
demo.cross2$Rep <- demo.cross2$lambda
demo.cross2$Sim <- FALSE
demo.cross3 <- rbind(demo.cross2, as.data.frame(demo.rep2)[, names(demo.cross2)])

p.cross28 <- ggplot(demo.cross3, aes(x = Time*g/u/1000, y = value, col = lambda, group = as.factor(Rep), alpha = Sim)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e5, fill = gray(0.5)) +
  geom_line(size = 1) + scale_alpha_manual(values = c("TRUE" = 0.3, "FALSE" = 1)) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() + guides(alpha = FALSE) +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross28

#pp2 <- plot_grid(p.pop, p.cross2, align = "h", labels = "AUTO")
#pp2
```

```{r}
demo.cross <- read.table("Mixed-Morocco.allrates.txt", header = TRUE)
demo.cross$Time <- with(demo.cross, (right_time_boundary + left_time_boundary) / 2)

library(reshape2)
demo.cross2 <- reshape2::melt(demo.cross, id.vars = c("Time", "time_index", "left_time_boundary", "right_time_boundary"), variable.name = "lambda")
demo.cross2$lambda <- factor(substring(demo.cross2$lambda, 8), levels = c("00", "11", "01"), labels = c("Within Mixed", "Within Morocco", "Cross"))

p.cross <- ggplot(demo.cross2, aes(x = Time*g/u/1000, y = value)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e6, fill = gray(0.5)) +
  geom_line(aes(col = lambda), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross





#library(cowplot)
#pp <- plot_grid(p.pop, p.cross, align = "h", labels = "AUTO")
#pp


# Look at permutations:

demo.rep.lst <- list()
for (i in 1:5) {
  tmp <- read.table(paste("Mixed-Morocco_", i, ".allrates.txt", sep = ""), header = TRUE)
  tmp$Time <- with(tmp, (right_time_boundary + left_time_boundary) / 2)
  tmp$Rep <- i
  demo.rep.lst[[i]] <- tmp
}
require(data.table)
demo.rep <- rbindlist(demo.rep.lst)

p.rep <- ggplot(demo.rep, aes(x = Time*g/u, y = lambda_01, group = as.factor(Rep))) + geom_line() +
  scale_y_log10() + scale_x_log10() +
  theme_bw()
p.rep

demo.rep2 <- demo.rep
demo.rep2$lambda <- "Randomized"
demo.rep2$value <- demo.rep2$lambda_01
demo.rep2$lambda_00 <- NULL
demo.rep2$lambda_01 <- NULL
demo.rep2$lambda_11 <- NULL
demo.rep2$Sim <- TRUE
demo.rep2$Rep <- as.factor(demo.rep2$Rep)
demo.cross2$Rep <- demo.cross2$lambda
demo.cross2$Sim <- FALSE
demo.cross3 <- rbind(demo.cross2, as.data.frame(demo.rep2)[, names(demo.cross2)])

p.cross29 <- ggplot(demo.cross3, aes(x = Time*g/u/1000, y = value, col = lambda, group = as.factor(Rep), alpha = Sim)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e5, fill = gray(0.5)) +
  geom_line(size = 1) + scale_alpha_manual(values = c("TRUE" = 0.3, "FALSE" = 1)) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10() + 
  ylab(expression(lambda)) + xlab("Time (ky)") +
  scale_color_colorblind() +
  theme_bw() + guides(alpha = FALSE) +
  theme(legend.position = "top", legend.direction = "vertical", legend.title = element_blank())
p.cross29
```

```{r}
library(ggpubr)

p.pop
#Iran
ggarrange(p.cross20, p.cross21,
          labels = c("A", "B"),
          ncol = 2, nrow = 1)

ggarrange(p.cross22,p.cross23,
          labels = c( "C","D"),
          ncol = 2, nrow = 1)

ggarrange(p.cross24,p.cross25,
          labels = c("E","F"),
          ncol = 2, nrow = 1)

ggarrange(p.cross26,p.cross27,
          labels = c("G","H"),
          ncol = 2, nrow = 1)

ggarrange(p.cross28,p.cross29,
          labels = c("I","J"),
          ncol = 2, nrow = 1)

```

```{r}
library(tidyverse)
u <- 3.3e-8
mu <- 3.01e-10
demo.cross_IRND <- read.table("Ir-ND.allrates.txt", header = TRUE)
demo.cross_IRND$Time <- with(demo.cross_IRND, (right_time_boundary + left_time_boundary) / 2)
demo.cross_IRND$rccr <-  (2*demo.cross_IRND$lambda_01)/(demo.cross_IRND$lambda_00+demo.cross_IRND$lambda_11)
demo.cross_IRND$pops <- "Iran and N.dakota"


p.cross <- ggplot(demo.cross_IRND, aes(x = Time*g/u/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("Iran and N.Dakota (mu = 3.3e-8)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme

p.cross <- ggplot(demo.cross_IRND, aes(x = Time*g/mu/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("Iran and N.Dakota (mu = 3.01e-10)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme

########################################################################################################

demo.cross_IRFR <- read.table("Ir-Fr.allrates.txt", header = TRUE)
demo.cross_IRFR$Time <- with(demo.cross_IRFR, (right_time_boundary + left_time_boundary) / 2)
demo.cross_IRFR$rccr <-  (2*demo.cross_IRFR$lambda_01)/(demo.cross_IRFR$lambda_00+demo.cross_IRFR$lambda_11)
demo.cross_IRFR$pops <- "Iran and Europe"

p.cross <- ggplot(demo.cross_IRFR, aes(x = Time*g/u/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("Iran and Europe (mu = 3.3e-8)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme


p.cross <- ggplot(demo.cross_IRFR, aes(x = Time*g/mu/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("Iran and Europe (mu = 3.01e-10)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme

###########################################################################################################


demo.cross_IRMI <- read.table("Ir-Mixed.allrates.txt", header = TRUE)
demo.cross_IRMI$Time <- with(demo.cross_IRMI, (right_time_boundary + left_time_boundary) / 2)
demo.cross_IRMI$rccr <-  (2*demo.cross_IRMI$lambda_01)/(demo.cross_IRMI$lambda_00+demo.cross_IRMI$lambda_11)
demo.cross_IRMI$pops <- "Iran and Mixed"

p.cross <- ggplot(demo.cross_IRMI, aes(x = Time*g/u/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("Iran and Mixed (mu = 3.3e-8)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme

p.cross <- ggplot(demo.cross_IRMI, aes(x = Time*g/mu/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("Iran and Mixed (mu = 3.01e-10)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme

################################################################################################################



demo.cross_IRMO <- read.table("Ir-Morocco.allrates.txt", header = TRUE)
demo.cross_IRMO$Time <- with(demo.cross_IRMO, (right_time_boundary + left_time_boundary) / 2)
demo.cross_IRMO$rccr <-  (2*demo.cross_IRMO$lambda_01)/(demo.cross_IRMO$lambda_00+demo.cross_IRMO$lambda_11)
demo.cross_IRMO$pops <- "Iran and Morocco"

p.cross <- ggplot(demo.cross_IRMO, aes(x = Time*g/u/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("Iran and Morocco (mu = 3.3e-8)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme

p.cross <- ggplot(demo.cross_IRMO, aes(x = Time*g/mu/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("Iran and Morocco (mu = 3.01e-10)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme

###############################################################################################################

demo.cross_NDFR <- read.table("ND_Fr.allrates.txt", header = TRUE)
demo.cross_NDFR$Time <- with(demo.cross_NDFR, (right_time_boundary + left_time_boundary) / 2)
demo.cross_NDFR$rccr <-  (2*demo.cross_NDFR$lambda_01)/(demo.cross_NDFR$lambda_00+demo.cross_NDFR$lambda_11)
demo.cross_NDFR$pops <- "N.dakota and Europe"

p.cross <- ggplot(demo.cross_NDFR, aes(x = Time*g/u/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("N.Dakota and Europe (mu = 3.3e-8)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme

p.cross <- ggplot(demo.cross_NDFR, aes(x = Time*g/mu/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("N.Dakota and Europe (mu = 3.01e-10)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme

####################################################################################################################
demo.cross_NDMI <- read.table("ND_Mixed.allrates.txt", header = TRUE)
demo.cross_NDMI$Time <- with(demo.cross_NDMI, (right_time_boundary + left_time_boundary) / 2)
demo.cross_NDMI$rccr <-  (2*demo.cross_NDMI$lambda_01)/(demo.cross_NDMI$lambda_00+demo.cross_NDMI$lambda_11)
demo.cross_NDMI$pops <- "N.dakota and Mixed"

p.cross <- ggplot(demo.cross_NDMI, aes(x = Time*g/u/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("N.Dakota and Mixed (mu = 3.3e-8)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme


p.cross <- ggplot(demo.cross_NDMI, aes(x = Time*g/mu/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("N.Dakota and Mixed (mu = 3.01e-10)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme

#################################################################################################################


demo.cross_NDMO <- read.table("ND_Morocco.allrates.txt", header = TRUE)
demo.cross_NDMO$Time <- with(demo.cross_NDMO, (right_time_boundary + left_time_boundary) / 2)
demo.cross_NDMO$rccr <-  (2*demo.cross_NDMO$lambda_01)/(demo.cross_NDMO$lambda_00+demo.cross_NDMO$lambda_11)
demo.cross_NDMO$pops <- "N.dakota and Morocco"

p.cross <- ggplot(demo.cross_NDMO, aes(x = Time*g/u/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("N.Dakota and Morocco (mu = 3.3e-8)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme


p.cross <- ggplot(demo.cross_NDMO, aes(x = Time*g/mu/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("N.Dakota and Morocco (mu = 3.01e-10)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme

############################################################################################################



demo.cross_FRMI <- read.table("Fr-Mixed.allrates.txt", header = TRUE)
demo.cross_FRMI$Time <- with(demo.cross_FRMI, (right_time_boundary + left_time_boundary) / 2)
demo.cross_FRMI$rccr <-  (2*demo.cross_FRMI$lambda_01)/(demo.cross_FRMI$lambda_00+demo.cross_FRMI$lambda_11)
demo.cross_FRMI$pops <- "Europe and Mixed"

p.cross <- ggplot(demo.cross_FRMI, aes(x = Time*g/u/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("Europe and Mixed (mu = 3.3e-8)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme


p.cross <- ggplot(demo.cross_FRMI, aes(x = Time*g/mu/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("Europe and Mixed (mu = 3.01e-10)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme


###########################################################################################################

demo.cross_FRMO <- read.table("Fr-Morocco.allrates.txt", header = TRUE)
demo.cross_FRMO$Time <- with(demo.cross_FRMO, (right_time_boundary + left_time_boundary) / 2)
demo.cross_FRMO$rccr <-  (2*demo.cross_FRMO$lambda_01)/(demo.cross_FRMO$lambda_00+demo.cross_FRMO$lambda_11)
demo.cross_FRMO$pops <- "Europe and Morocco"
#demo.cross_FRMO <- demo.cross_FRMO %>% slice(1:28)

p.cross <- ggplot(demo.cross_FRMO, aes(x = Time*g/u/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("Europe and Morocco (mu = 3.3e-8)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme


p.cross <- ggplot(demo.cross_FRMO, aes(x = Time*g/mu/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("Europe and Morocco (mu = 3.01e-10)")+ ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme
################################################################################################################


demo.cross_MIMO <- read.table("Mixed-Morocco.allrates.txt", header = TRUE)
demo.cross_MIMO$Time <- with(demo.cross_MIMO, (right_time_boundary + left_time_boundary) / 2)
demo.cross_MIMO$rccr <-  (2*demo.cross_MIMO$lambda_01)/(demo.cross_MIMO$lambda_00+demo.cross_MIMO$lambda_11)
demo.cross_MIMO$pops <- "Mixed and Morocco"
#demo.cross_MIMO <- demo.cross_MIMO %>% slice(1:27)

p.cross <- ggplot(demo.cross_MIMO, aes(x = Time*g/u/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("Mixed and Morocco (mu = 3.3e-8)") + ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme

p.cross <- ggplot(demo.cross_MIMO, aes(x = Time*g/mu/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1, fill = gray(0.5)) +
  geom_line(aes(col = rccr), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
 # scale_y_log10() + 
  ylab(expression(rccr)) + xlab("Time (ky)") + ggtitle("Mixed and Morocco (mu = 3.01e-10)") + ylab("RCCR") +
  geom_hline(yintercept=0.5, color = "dark red") + 
  #scale_color_binned() +
  theme_bw()
personal_theme = theme(plot.title = element_text(hjust = 0.5))
p.cross + personal_theme


###################################################################################################################

df3 <- rbind(demo.cross_IRND, demo.cross_IRFR,demo.cross_IRMI,demo.cross_IRMO,demo.cross_NDFR,demo.cross_NDMI,demo.cross_NDMO,demo.cross_FRMI,demo.cross_FRMO,demo.cross_MIMO)

p.cross <- ggplot(df3, aes(x = Time*g/u/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1.5, fill = gray(0.5)) +
  geom_line(aes(col = pops, alpha = 0.3), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) + ylim(0,2.5) +
  #scale_y_log10() + 
  ylab(expression(pops)) + xlab("Time (ky)") + ylab("RCCR")+
  scale_color_discrete() +
  theme_bw() +
  theme(legend.direction = "vertical", legend.title = element_blank())

p.cross
p.cross <- ggplot(df3, aes(x = Time*g/mu/1000, y = rccr)) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1.5, fill = gray(0.5)) +
  geom_line(aes(col = pops, alpha = 0.3), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) + ylim(0,2.5) +
  #scale_y_log10() + 
  ylab(expression(pops)) + xlab("Time (ky)") + ylab("RCCR")+
  scale_color_discrete() +
  theme_bw() +
  theme(legend.direction = "vertical", legend.title = element_blank())
p.cross

```

```{r}
u <- 3.01e-10

g <- 1
p.pop <- ggplot(demo, aes(x = Time*g/u/1000, y = (1/lambda)/(2*u))) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e8, fill = gray(0.5)) +
  geom_line(aes(col = Population), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10(breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) + 
  ylab(expression(Ne)) + xlab("Time (ky)") + ggtitle("mu = 3.01e-10 (Zymoseptoria mitotic mu (Habig et al. 2021))") +
  scale_color_brewer(type = "qual", palette = 1) +
  theme_bw() + theme(legend.position = "top", legend.direction = "vertical")
p.pop + personal_theme

u <- 3.01e-9

g <- 1
p.pop <- ggplot(demo, aes(x = Time*g/u/1000, y = (1/lambda)/(2*u))) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e8, fill = gray(0.5)) +
  geom_line(aes(col = Population), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10(breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) + 
  ylab(expression(Ne)) + xlab("Time (ky)") + ggtitle("mu = 3.01e-9") +
  scale_color_brewer(type = "qual", palette = 1) +
  theme_bw() + theme(legend.position = "top", legend.direction = "vertical")
p.pop + personal_theme


u <- 3.3e-8

g <- 1
p.pop <- ggplot(demo, aes(x = Time*g/u/1000, y = (1/lambda)/(2*u))) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e8, fill = gray(0.5)) +
  geom_line(aes(col = Population), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10(breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) + 
  ylab(expression(Ne)) + xlab("Time (ky)") + ggtitle("mu = 3.3e-8 (yeast, (Lynch et al. 2008))") +
  scale_color_brewer(type = "qual", palette = 1) +
  theme_bw() + theme(legend.position = "top", legend.direction = "vertical")
p.pop + personal_theme

u <- 5.8e-7

g <- 1
p.pop <- ggplot(demo, aes(x = Time*g/u/1000, y = (1/lambda)/(2*u))) +
  annotate("rect", xmin = 6, xmax = 10, ymin = 0, ymax = 1e8, fill = gray(0.5)) +
  geom_line(aes(col = Population), size = 1) +
  scale_x_continuous(trans = "log10",
                     breaks = c(0.1, 1, 10, 100, 1000), 
                     minor_breaks = c(0.5, 1, 5, 50, 500), 
                     labels = scales::comma_format(accuracy = 0.1)) +
  scale_y_log10(breaks=c(1e3,1e4,1e5,1e6,1e7,1e8)) + 
  ylab(expression(Ne)) + xlab("Time (ky)") + ggtitle("mu = 5.8e-7 (yeast (schacherer et al. 2009))") +
  scale_color_brewer(type = "qual", palette = 1) +
  theme_bw() + theme(legend.position = "top", legend.direction = "vertical")
p.pop + personal_theme



```

